特定健診・特定保健指導データ交換用CSVファイルのXML変換および納品ルール準拠ガイド
1. 序論 (Introduction)
1.1. 本報告書の目的 (Purpose of this Report)
本報告書は、提供された全文書（既存のPDF群および新たに提供される補足資料4点を含む）に基づき、特定健診・特定保健指導データ交換に用いられるCSV形式のデータを、指定されたXMLファイル群へと変換し、かつ、定められた納品ルール（ファイル命名規則、フォルダ構成、アーカイブ方法等）を厳格に遵守して納品するための、網羅的かつ実践的な手順を解説することを目的とします。このプロセスは、データ交換の正確性と効率性を担保する上で極めて重要です。
利用者は複数の技術文書を参照する必要があり、本報告書はこれらの情報を統合し、一貫性のある実行可能な指針を提供することを目指します。特に、「納品ルールを遵守した上で」という要件は、単にXMLファイルの内容を正しく生成するだけでなく、ファイル名、フォルダ構造、アーカイブ方法といった納品パッケージ全体が技術仕様に完全に準拠していることが求められる点を強調しています。したがって、本報告書は、データ変換の技術的側面と、納品規定の遵守という両面からのアプローチを提供します。
1.2. 特定健診・特定保健指導データ交換の概要と関連XMLファイル (Overview of Specific Health Checkup/Guidance Data Exchange and Involved XML Files)
特定健診・特定保健指導データの電子的な交換は、医療情報の標準化と効率的な共有を促進し、国民の健康増進に寄与する上で不可欠な取り組みです。このデータ交換プロセスにおいては、複数の標準化されたXMLファイルが用いられ、それぞれが特定の役割を担っています。
主要なXMLファイル群には、交換用基本情報ファイル、特定健診情報ファイル、特定保健指導情報ファイル、それぞれの決済情報ファイル、そして決済情報集計ファイルが含まれます 1。これらのファイルは独立して存在するのではなく、相互に関連し合い、一つのまとまったデータパッケージを形成します。例えば、「交換用基本情報ファイル」は、個々の受診者の健診情報ファイルや決済情報ファイルを紐付ける役割を果たし、データセット全体の一貫性を保証します 1。
このデータ交換システムは、特定健診データと特定保健指導データを明確に分離し、さらにそれぞれについて情報ファイルと決済情報ファイルを分けるという、モジュール化された設計思想に基づいています 1。このような構造は、異なるデータ提出シナリオ（例えば、健診結果のみを先行して提出し、決済情報は後日提出するケースなど）や、健診と保健指導のデータフローをある程度独立して処理するような、柔軟な運用を可能にすることを意図していると考えられます。各XMLファイルが持つ固有の役割を理解することは、正確なデータ変換と適切なファイル作成の前提となります。
2. CSVデータの準備と理解 (Preparing and Understanding Source CSV Data)
2.1. 提供文書に基づくCSVデータ構造の解釈 (Interpreting CSV Data Structure based on Provided Documents)
CSVファイルからXMLファイルへの変換プロセスの最初のステップは、変換元となるCSVファイルのデータ構造を正確に理解することです。この理解は、提供された技術文書、特に「参考資料」1、「XML用特定健診項目情報」1、および「XML用特定保健指導項目情報」1 を参照することによって深められます。これらの文書には、XMLファイルに格納されるべきデータ項目、その意味、データ型、コード値、単位などが詳細に定義されており、CSVファイルはこれらの定義に準拠したデータを含んでいる必要があります。
CSVファイルは、最終的に生成されるXMLファイルのデータ要件を満たすための中間的なデータ表現と捉えるべきです。つまり、CSVファイルの各列が、どのXMLファイルのどの要素または属性に対応するのかを初期段階で明確に対応付ける必要があります。この対応付けは、単にCSVの列名とXMLの要素名を照合するだけでなく、データの意味内容や形式が一致しているかを確認する作業を含みます。例えば、1や1に記載されている項目コード、データタイプ、単位といった情報は、CSVデータがこれらの仕様に準拠しているかを検証する上での基準となります。したがって、CSVデータの各項目が、これらの技術文書で定義された情報とどのように関連しているかを正確に把握することが、後続の変換プロセスの正確性を保証する上で不可欠です。
2.2. 特定健診・特定保健指導の主要データ項目 (Key Data Elements for Specific Health Checkups and Guidance)
特定健診および特定保健指導のXMLファイルを作成する上で、その中核となるのは「XML用特定健診項目情報」1 および「XML用特定保健指導項目情報」1 に定義されている主要データ項目です。これらの文書は、データ交換における辞書的役割を果たし、各データ要素の正確な定義を理解するための基礎となります。
特定健診情報ファイルでは、身体計測（身長、体重、BMI、腹囲など）、血圧測定結果、脂質検査結果（総コレステロール、HDLコレステロール、LDLコレステロール、中性脂肪など）、血糖検査結果（空腹時血糖、HbA1cなど）、尿検査結果（尿糖、尿蛋白など）、および問診項目（服薬歴、喫煙歴など）が主要なデータ項目として挙げられます 1。これらの項目は、それぞれ固有の「項目コード」、データ型（例：物理量を表すPQ、コード値を表すCD、文字列を表すST）、単位（例：cm, kg, mg/dL）、そして場合によっては検査方法コードや関連するOID（オブジェクトID）が指定されています 1。
同様に、特定保健指導情報ファイルでは、保健指導区分、行動変容ステージ、目標設定値（目標腹囲、目標体重など）、支援内容（初回面接、継続支援、中間・最終評価）、評価項目などが主要なデータ項目となります 1。これらの項目も、固有の「項目コード」、データ型、コード値、関連OIDなどが定義されています。
これらの仕様が示すデータの詳細度、例えば1において複数の種類のコレステロール測定が異なる検査方法コードと共にリストされている点は、CSVファイルがこの要求される詳細レベルでデータを提供する必要があることを意味します。項目コード、データ型、単位、OIDなどを用いた標準化されたデータ表現は、データが機械可読な方法で一貫して表現されることを保証し、異なるシステム間での相互運用性の基盤となります。CSVからXMLへの変換時には、これらのデータ特性を正確に反映させることが極めて重要です。
2.3. データ品質と処理ルール (Data Quality Considerations and Handling Rules)
CSVデータをXMLへ変換する際には、データの品質を確保し、標準仕様に準拠した形で情報を表現するために、提供文書、特に「参考資料」1に定められたデータ処理ルールを厳格に適用する必要があります。これらのルールは、CSVデータの事前処理段階、またはXMLへの変換ロジック内で実装されなければなりません。
主な処理ルールは以下の通りです。
● 数値データの丸め方: 数値データで丸め処理が必要な場合は、全ての項目において四捨五入により指定された桁数にします。桁数の情報は「XML用特定健診項目情報」1の「数値型の場合の形式」に従います。計算によって整数値化する場合も、小数点以下1位まで計算し四捨五入により整数値化します 1。このルールは、XMLファイルに書き出される数値の精度を保証します。
● 小数点以下の扱い:
○ ファイル作成側において、小数点以下n桁の指示がある場合にその桁の数値が0であれば、0を出力する必要はありません（例：身長180.0cmは180と出力可能）1。
○ ファイル受理側は、小数点以下n桁の指示があるにもかかわらずn未満の桁数しか存在しないデータを受理した場合、その桁の値を0とみなし処理します 1。これにより、データ形式の柔軟性が保たれます。
● 桁数超過: 測定値が「XML用特定健診項目情報」1の「最大バイト長」や「数値型の場合の形式」で定められた表現範囲を超えた場合、表現範囲の最大値を記載します（例：「数値型の場合の形式」が"NNNNN"ならば"99999"を記載）1。これはデータ格納時のエラーを防ぐために重要です。
● 欠損値の基本的な考え方と処理:
○ 必須項目について、当該検査項目コードが出現しない、または「未実施」として報告された場合は欠損として扱われます 1。
○ 問診における必須項目が未回答の場合、実施機関が独自に値を設定することは許されず、「未実施」または「判定不能」として記述され、欠損値扱いとなります 1。
○ 欠損値の具体的な表現方法（例：「9埋め+H」、「値+H」、「測定不能」、「未実施」などのコードや特定の数値表現）は、1の表に示されており、これに従ってXMLファイル内に値を設定する必要があります。この標準化された欠損値表現は、受信システムによる一貫したデータ解釈に不可欠です。
これらのデータ処理ルールを正確に適用することは、データの品質を維持し、後続の処理、例えば1に詳述されているメタボリックシンドローム判定や保健指導レベル判定のロジックが正しく機能するための前提となります 1。CSVデータに含まれる値がこれらのルールに従って適切に処理・変換されなければ、判定結果の誤りやデータの不整合を引き起こす可能性があります。したがって、変換プロセスにおいては、これらのルールを組み込んだデータクレンジングや検証ロジックの実装が求められます。
3. CSVから各XMLファイル形式への変換 (Converting CSV to Specific XML File Formats)
3.1. CSVからXMLへのマッピング基本原則 (General Principles of Mapping CSV to XML)
CSVファイルから特定健診・特定保健指導データ交換用の各種XMLファイルへの変換は、単なるデータ形式の置き換えではなく、厳格なスキーマ定義とデータ処理ルールに基づいた精密なマッピング作業を伴います。このマッピングの基本原則を理解することは、正確で仕様に準拠したXMLファイルを生成するための第一歩です。
XMLスキーマ（XSDファイル）は、ターゲットとなる各XMLファイルの構造、要素名、属性名、データ型、出現順序、繰り返し回数などを定義する設計図の役割を果たします 1。したがって、CSVからXMLへの変換プロセス全体は、このスキーマ定義に厳密に従う必要があります。CSVファイルは一般的にXMLスキーマほど厳密な型制約を持たないため、変換過程でのデータ型変換はほぼ不可避です。例えば、CSVファイル内で文字列として表現されている日付データは、XMLで要求される特定のYYYYMMDD形式の文字列やxs:date型に変換する必要があります。同様に、数値データもXMLで定義された整数型や実数型に適切に変換し、1で規定された丸め処理や小数点以下の処理ルールを適用しなければなりません 1。
さらに、多くのXML要素や属性では、1、1、1などで定義された特定のコード値の使用が求められます。CSVデータがこれらのコード値を直接含んでいない場合、CSV内の値をこれらの標準コードに変換するロジックが必要になります。例えば、性別を表すCSVの列が「男性」「女性」といった文字列で記録されている場合、XMLでは「1」（男性）、「2」（女性）といったコード値に変換し、対応するOIDを@codeSystem属性に設定する必要があります。
このマッピングプロセスは、CSVの各列を機械的にXMLの要素や属性に割り当てるだけでは不十分であり、データの意味内容を理解した上で、XMLスキーマの要求する構造とセマンティクスに合致するようにデータを配置し、必要に応じて変換・検証する作業が求められます。
3.2. 各XMLファイルへの詳細変換手順 (Detailed Conversion Steps for Each Required XML File Type)
特定健診・特定保健指導データ交換システムでは、複数の異なるXMLファイルが連携して用いられます。各ファイルは固有の目的と構造を持ち、CSVからのデータマッピングもそれぞれ特有のルールに従う必要があります。以下に、主要なXMLファイルごとの変換手順の要点を詳述します。
3.2.1. 交換用基本情報ファイル (Exchange Basic Information File - ix08_V08.xml)
交換用基本情報ファイル（ix08_V08.xml）は、送付されるXMLファイル群全体のメタデータを記述するインデックスファイルとしての役割を担います 1。このファイルには、送信元機関、送信先機関、ファイル作成日、アーカイブに含まれるデータファイルと決済情報ファイルの総数などの情報が含まれます。
CSVデータからは、個々の受診者データではなく、主に提出バッチ全体に関する情報がマッピングされます。例えば、提出元機関コード、提出先機関コード、提出日といった情報は、CSVの管理情報列やシステムパラメータから取得されることが想定されます。
主要な要素とその設定内容は以下の通りです 1。
● <index>: ルート要素です。
● <interactionType @code="...">: 種別コード。送信元と送信先の関係性（例：「6」特定健診/保健指導機関→保険者）を示します。このコードは1の表8や1の表3で定義されており、提出シナリオに応じて適切な値を設定する必要があります。
● <creationTime @value="...">: ファイル作成日をYYYYMMDD形式で設定します。
● <sender>/<id @extension="..." @root="...">: 送信元機関の機関番号を@extensionに、その機関番号の種類を識別するOID（1の表11などから選択）を@rootに設定します。
● <receiver>/<id @extension="..." @root="...">: 送信先機関の情報を同様に設定します。
● <serviceEventType @code="...">: 実施区分コード。提出するデータが特定健診情報か特定保健指導情報かなどを示します（例：「1」特定健診情報）。1の表9や1の表2で定義されています。
● <totalRecordCount @value="...">: DATAフォルダおよびCLAIMSフォルダ内に格納されるXMLファイルの総数を設定します。この値は、個々のデータファイルと決済情報ファイルを生成した後に計算される動的な値です。
このファイルの正確な生成は、受信システムが提出パッケージ全体の文脈と内容を正しく解釈するために不可欠です。特に、各種コード値（種別コード、実施区分コード）とOIDの適切な選択は、提出シナリオの正確な表現に直結します。
3.2.2. 特定健診情報ファイル (Specific Health Checkup Information File - hc08_V08.xml)
特定健診情報ファイル（hc08_V08.xml）は、個々の受診者の特定健診結果（検査測定値、問診回答など）を格納するための主要なデータファイルであり、HL7 Clinical Document Architecture Release 2 (CDA R2) 規格に準拠して構成されます 1。このファイルは、CDAヘッダ部とCDAボディ部から成ります。
CSVデータからは、受診者ID、氏名、生年月日、性別、住所、郵便番号といった受診者基本情報、健診実施日、健診機関情報、そして身長、体重、血圧、各種血液検査値、尿検査結果、問診回答といった詳細な健診項目データがマッピングされます。
CDAヘッダ部:
ヘッダ部には、文書のメタ情報、受診者情報、作成機関情報、健診実施情報などが格納されます 1。
● <ClinicalDocument>/<typeId @root="..." @extension="..."/>: CDA R2仕様を識別する固定値を設定します。
● <ClinicalDocument>/<id @nullFlavor="NI"/>: 文書インスタンスの一意識別子ですが、本仕様では「情報なし」を示す"NI"を設定します。
● <ClinicalDocument>/<code @code="10" @codeSystem="1.2.392.200119.6.1001"/>: 報告区分コードとして「10」（特定健診情報）を設定します。
● <ClinicalDocument>/<effectiveTime @value="..."/>: ファイル作成日をYYYYMMDD形式で設定します。
● <ClinicalDocument>/<confidentialityCode @code="N"/>: 守秘レベルとして「N」（通常）を設定します。
● <ClinicalDocument>/<recordTarget>: 受診者情報を格納します。保険者番号、被保険者証記号・番号・枝番、氏名（カナ）、性別コード（1:男, 2:女）、生年月日（YYYYMMDD）、郵便番号、住所などがCSVからマッピングされます。各IDには、1で定義された対応するOIDが@root属性に設定されます。
● <ClinicalDocument>/<author>: ファイル作成機関（通常は健診実施機関）の情報を格納します。機関番号、機関名称、電話番号、住所、郵便番号などが設定され、機関番号の@root属性には1で定義された機関種別OID（例：特定健診機関番号は1.2.392.200119.6.102）が使用されます。
● <ClinicalDocument>/<custodian>: ファイル作成管理責任機関情報。CDA R2規格上は必須ですが、本仕様ではid/@nullFlavor="NI"として実質的に使用しません。
● <ClinicalDocument>/<participant>: 受診券情報を格納します（任意）。受診券整理番号、有効期限、発行保険者番号などが含まれ、関連するOIDが使用されます。
● <ClinicalDocument>/<documentationOf>/<serviceEvent>: 健診実施情報を格納します。健診実施年月日、健診プログラムサービスコード（1で定義されたコード、例：「010」特定健診）、健診実施機関の機関番号、名称などが含まれます。
CDAボディ部:
ボディ部には、実際の健診結果が構造化されて格納されます 1。
● <component>/<structuredBody>/<component>/<section>: 健診結果のセクション。
○ <section>/<code @code="01010" @codeSystem="1.2.392.200119.6.1010"/>: 特定健診検査・問診セクションを示します。
○ <section>/<text>: 人が解釈するための説明ブロック（ナラティブブロック）。1の指示に従い、身長、体重、BMI、腹囲、メタボリックシンドローム判定、保健指導レベルといった一部の項目のみをリスト形式で記述することが推奨されます（任意）。
○ <section>/<entry>: 各検査項目および問診項目の結果を格納するエントリ。
■ <observation @classCode="OBS" @moodCode="EVN">: 個々の検査・問診結果を表現します。
■ <code>: 検査・問診項目を識別します。
■ @code: 「XML用特定健診項目情報」1に記載の「項目コード」（JLAC10準拠の17桁コード）を設定します。
■ @codeSystem: 「1.2.392.200119.6.1005」を設定します。
■ <value>: 検査・問診結果の値を格納します。
■ @xsi:type: 1に記載の「XMLデータ型」（例：PQ、CD、ST）を設定します。
■ PQ型（物理量）の場合: @valueに数値、@unitに1記載の「XML用単位」を設定します。1の数値処理ルール（丸め、小数点、桁数超過）を適用します。
■ CD型（コード値）の場合: @codeに1記載のコード値、@codeSystemに当該コード体系のOIDを設定します。
■ @nullFlavor="NI": 測定不能の場合に設定します。
■ negationInd="true": 未実施の場合に設定します（この場合<value>要素は通常出現しません）。
■ <interpretationCode @code="..."/>: 検査値の解釈（例：H:高値、L:低値、N:基準範囲内）を設定します。1の桁数超過時のH/L表記もこれに該当します。
■ <methodCode @code="..." @codeSystem="1.2.392.200119.6.1007"/>: 1記載の「XML検査方法コード」を設定します。
■ <referenceRange>: 検査基準値を設定します。
■ 一連検査グループ: 貧血検査項目群のように関連する複数の検査結果は、entry/observationのネスト構造とentryRelationship要素（@typeCode="COMP"など）を用いてグループ化して表現します 1。
このファイルの生成には、HL7 CDA R2の構造への深い理解、1で定義される詳細な健診項目情報とCSVデータの正確なマッピング、1で規定されるデータハンドリングルールの厳密な適用、そして1で定義されるOIDの正しい使用が求められます。特に、1のルール（範囲外値のH/L表現、未実施のnegationInd、測定不能のnullFlavorなど）は、単純なデータマッピングではなく、条件に応じた変換ロジックの実装を必要とします。
3.2.3. 特定保健指導情報ファイル (Specific Health Guidance Information File - hg08_V08.xml)
特定保健指導情報ファイル（hg08_V08.xml）は、個々の利用者の特定保健指導の実施内容（計画、支援の記録、評価など）を時系列に沿って記録するためのファイルであり、これもHL7 CDA R2規格に準拠します 1。
CSVデータからは、利用者の基本情報に加え、保健指導の区分（積極的支援、動機付け支援など）、行動変容ステージ、設定された目標値（腹囲、体重など）、初回面接の内容、継続的な支援の記録（実施日、支援形態、時間、ポイントなど）、中間評価および最終評価の結果などがマッピングされます。
CDAヘッダ部:
ヘッダ部の構造は特定健診情報ファイルと類似していますが、保健指導特有の情報が設定されます 1。
● <ClinicalDocument>/<code @code="..." @codeSystem="1.2.392.200119.6.1001"/>: 報告区分コードとして、指導の段階（例：「21」開始時、「22」実績評価時、「23」途中終了時、「25」初回未完了など、1および1参照）に応じた値を設定します。
● その他、typeId, id, effectiveTime, confidentialityCode, recordTarget, author, custodianは特定健診情報ファイルと同様の考え方で設定します。
● <ClinicalDocument>/<participant>: 利用券情報を格納します（任意）。
● <ClinicalDocument>/<documentationOf>/<serviceEvent>: 保健指導の実施基本情報を格納します。プログラムサービスコードには保健指導を示すコード（例：「100」特定保健指導、1参照）を設定します。effectiveTimeは報告時点（初回面接日、中間評価日、最終評価日など）に応じて設定されます。
CDAボディ部:
ボディ部は、保健指導のプロセスを反映した複数のセクションで構成されます 1。
● <component>/<structuredBody>/<component>/<section>: 各指導内容に対応するセクション。
○ <section>/<code @code="..." @codeSystem="1.2.392.200119.6.1010"/>: 各セクションを識別するコード（1および1参照）。
■ 「90010」: 指導共通情報セクション
■ 「90020」: 指導初回①情報セクション（初回面接分割時のみ）
■ 「90030」: 指導初回情報セクション
■ 「90070」: 指導集計情報セクション
■ 「90040」: 継続支援情報セクション
■ 「90050」: 中間評価情報セクション
■ 「90060」: 最終評価情報セクション
■ 「90080」: 指導機関情報セクション
○ <section>/<text>: 指導共通情報セクションを除き、通常は空の要素です。
○ <section>/<entry>: 各指導項目や評価項目の詳細を格納するエントリ。
■ 主に<act>要素（指導行為や計画）や<observation>要素（観察結果や評価値）が用いられます。
■ <code>: 指導項目を識別します。
■ @code: 「XML用特定保健指導項目情報」1に記載の「項目コード」を設定します。
■ @codeSystem: 「1.2.392.200119.6.1006」を設定します。
■ <value>: 指導項目の値を格納します。
■ @xsi:type: 1記載の「XML 用データ型」（CD, ST, PQ, INT, TSなど）を設定します。
■ CD型の場合: @codeに1記載のコード値、@codeSystemに当該コード体系のOIDを設定します。
■ ST型（文字列）の場合: text()に文字列値を設定します。
■ PQ型（物理量）/INT型（整数）の場合: @valueに数値、必要に応じて@unitに1記載の単位を設定します。
■ <effectiveTime>: 実施日や期間などを設定します。
■ <performer>: 実施者（医師、保健師、管理栄養士など）の情報を設定します。
各セクションの主な内容とCSVからのマッピング:
● 指導共通情報セクション (90010): 保健指導区分、行動変容ステージ、保健指導コース名、健診実施年月日（確認用）、保健指導後服薬状況など 1。
● 指導初回①情報セクション (90020): 初回面接を分割実施した場合の1回目の面接日、支援形態、実施時間、実施者、および保健指導計画（目標腹囲、目標体重、生活習慣改善計画など）1。
● 指導初回情報セクション (90030): 初回面接（分割しない場合、または分割した場合の2回目）の実施日、支援形態、実施時間、実施者、健診後早期の初回面接該否、および保健指導計画 1。
● 指導集計情報セクション (90070): 計画上および実施上の支援回数、合計時間、獲得ポイントなどを集計して格納します 1。これらの多くは個別の支援記録から計算される値です。
● 継続支援情報セクション (90040): 複数回の継続支援の各回について、実施日、支援形態、実施時間、獲得ポイント、実施者、支援内容のテキスト情報などを記録します 1。CSVの繰り返し支援記録に対応します。
● 中間/最終評価情報セクション (90050/90060): 評価実施日、支援形態、実施者、評価時の腹囲・体重・血圧、生活習慣改善状況、獲得ポイントなどを記録します 1。
● 指導機関情報セクション (90080): 指導を実施した機関の情報を記録します（任意）1。
このファイルもまた、CDA R2準拠と保健指導プロセスの段階的記録という複雑さを持ちます。CSVデータは、指導の各段階（初回、継続、評価）の情報を区別して保持し、それぞれ対応するXMLセクション・エントリに正しくマッピングされる必要があります。1で定義される多数のコード値（保健指導区分、支援形態、改善度評価など）の正しい適用が求められます。
3.2.4. 特定健診決済情報ファイル (Specific Health Checkup Settlement Information File - cc08_V08.xml)
特定健診決済情報ファイル（cc08_V08.xml）は、特定健診にかかる費用請求のための情報を格納します 1。このファイルはCDA R2ベースではなく、よりシンプルな構造を持っています。
CSVデータからは、健診実施機関番号、保険者番号、受診者の被保険者情報、受診券情報（窓口負担の種別や金額/率）、請求区分（基本的な健診のみ、詳細な健診含む等）、委託料単価、実際に徴収した窓口負担額、最終的な請求金額などがマッピングされます。
主要な要素とその設定内容は以下の通りです 1。
● <checkupClaim>: ルート要素です。
● <encounter>: 受診情報。
○ <serviceEventType @code="1"/>: 実施区分として「1」（特定健診）を設定します。
○ <performerOrganization>/<id @extension="..." @root="1.2.392.200119.6.102"/>: 特定健診機関番号を設定します。
● <subjectPerson>: 受診者情報。保険者番号、被保険者証記号・番号・枝番、氏名（カナ）、生年月日、性別、郵便番号、住所などを格納します。
● <checkupCard>: 特定健診受診券情報。
○ <id @extension="..." @root="1.2.392.200119.6.209"/>: 受診券整理番号を設定します。
○ <effectiveTime>/<high @value="..."/>: 受診券の有効期限をYYYYMMDD形式で設定します。
○ <chargeTypeBasic @code="...">, <chargeTypeDetail @code="...">, <chargeTypeOther @code="...">, <chargeTypeHumanDryDock>: それぞれ基本的な健診、詳細な健診、追加健診、人間ドックに関する窓口負担情報を格納します。@codeには窓口負担コード（1 表16）を設定し、必要に応じて<amount @value="..."/>（負担額、6桁固定ゼロ埋め）または<rate @value="..."/>（負担率、6桁固定ゼロ埋め、例：1%は001000）を設定します。これらの要素の出現は、後述の<settlement>/<claimType>の値に依存します 1。
● <settlement>: 決済情報。
○ <claimType @code="..."/>: 請求区分コード（1 表20）を設定します。
○ <commissionType @code="..."/>: 委託料単価区分コード（1 表22）を設定します。
○ <unitPriceBasic>/<amount @value="..."/>, <unitPriceDetail>/<amount @value="..."/>, <unitPriceOther>/<amount @value="..."/>: 各健診区分の単価（9桁以内整数）を設定します。<unitPriceDetail>や<unitPriceOther>は複数出現可能で、<observation @code="..."/>で詳細健診項目コード（1 表21）や追加健診項目コードを示します。
○ <paymentForBasic>/<amount @value="..."/> など: 各健診区分の窓口負担額。
○ <claimAmount @value="..."/>: 最終的な請求金額（9桁以内整数）を設定します。
● <agencyAdjudicationResult>, <insurerAdjudicationResult>: 返戻の場合にのみ出現し、返戻理由コード（1 表18, 表19）などを格納します。
このファイルの生成では、請求区分コードに応じて必要な窓口負担情報要素や単価情報要素を条件分岐して出力するロジックが重要となります。金額や率の固定桁数・ゼロ埋めルールも遵守が必要です。
3.2.5. 特定保健指導決済情報ファイル (Specific Health Guidance Settlement Information File - gc08_V08.xml)
特定保健指導決済情報ファイル（gc08_V08.xml）は、特定保健指導にかかる費用請求のための情報を格納します 1。構造は特定健診決済情報ファイルと類似していますが、保健指導特有の項目が含まれます。
CSVデータからは、指導実施機関番号、保険者番号、利用者の被保険者情報、利用券情報（窓口負担の種別や金額/率）、保健指導区分（積極的支援、動機付け支援など）、実施時点（開始時、実績評価時など）、単価、支払割合、実施ポイント数、算定金額、請求金額などがマッピングされます。
主要な要素とその設定内容は以下の通りです 1。
● <healthGuidanceClaim>: ルート要素です。
● <encounter>: 利用情報。
○ <serviceEventType @code="2"/>: 実施区分として「2」（特定保健指導）を設定します。
○ <guidanceLevel @code="..."/>: 保健指導区分コード（1 表13、1参照）を設定します。
○ <guidanceTiming @code="..."/>: 保健指導実施時点コード（1 表12、1参照）を設定します。
● <subjectPerson>: 利用者情報（特定健診決済情報ファイルと同様）。
● <healthGuidanceCard>: 特定保健指導利用券情報。
○ <id @extension="..." @root="1.2.392.200119.6.210"/>: 利用券整理番号を設定します。
○ <copayment @code="...">: 窓口負担コード（1 表16）を設定し、<amount @value="..."/>または<rate @value="..."/>を設定します。
○ <maxInsuranceLimit>: 保険者負担上限額の場合に設定します。
● <settlement>: 決済情報。
○ <unitPrice>/<amount @value="..."/>: 単価（9桁以内整数）を設定します。
○ <paymentRate @value="..."/>: 支払割合（%）を3桁以内で設定します。
○ <pointCountCompleted @value="..."/>: 実施済みポイント数（4桁以内整数）。積極的支援で実績評価時または途中終了時に必須です。
○ <pointCountIntended @value="..."/>: 計画上のポイント数（4桁以内整数）。積極的支援で途中終了時に必須です。
○ <calculatedAmount @value="..."/>: 算定金額（9桁以内整数）を設定します。
○ <payment>/<claimAmount @value="..."/>: 最終的な請求金額（9桁以内整数）を設定します。
○ <payment>/<copaymentCollected>/<status @code="..."/>: 窓口負担徴収コード（1 表20）を設定します。
● <agencyAdjudicationResult>, <insurerAdjudicationResult>: 返戻の場合にのみ出現します。
保健指導区分や実施時点に応じたポイント数の計上ルールなど、保健指導特有の決済ロジックを反映したデータマッピングが求められます。
3.2.6. 決済情報集計ファイル (Settlement Information Aggregation File - su08_V08.xml)
決済情報集計ファイル（su08_V08.xml）は、同一の送付ファイルアーカイブに含まれる特定健診決済情報ファイルおよび特定保健指導決済情報ファイルの件数や金額を集計して記述するものです 1。
このファイルは、CSVから直接的に多くの情報がマッピングされるわけではなく、主に同一アーカイブ内の他の決済情報ファイル（cc08_V08.xmlやgc08_V08.xml）の内容を集計した結果が格納されます。
主要な要素とその設定内容は以下の通りです 1。
● <Summary>: ルート要素です。
● <serviceEventType @code="..."/>: 実施区分コード（1 表4、1参照）。集計対象が特定健診なら「1」、特定保健指導なら「2」を設定します。
● <totalSubjectCount @value="..."/>: 当該アーカイブに含まれる受診者または利用者の総数（健診ファイルまたは指導ファイルの総数）を6桁以内で設定します。
● <totalCostAmount @value="..."/>: 単価または算定金額の総計を9桁以内で設定します。
● <totalPaymentAmount @value="..."/>: 窓口支払金額の総計を9桁以内で設定します。
● <totalPaymentByOtherProgram @value="..."/>: 他の法令に基づく検診等との共同実施の場合の他制度負担額の総計（健診の場合のみ、任意）。
● <totalClaimAmount @value="..."/>: 保険者への請求金額の総計を9桁以内で設定します。
このファイルの生成は、個別の決済情報XMLファイル群を生成した後、それらの内容を読み込んで集計処理を行うステップが必要となります。
提案する表1：特定健診情報ファイル（hc08_V08.xml）への主要項目マッピング例

項目名（日本語）項目コードXML要素パス (XPath形式例)XML属性/値データ型単位関連OID (コード体系など)備考（ルール適用箇所など）身長N001000000000001/ClinicalDocument/.../entry/observation[code/@code='N001000000000001']/value@value / @unitPQcm-1: 丸め、小数点体重N006000000000001/ClinicalDocument/.../entry/observation[code/@code='N006000000000001']/value@value / @unitPQkg-1: 丸め、小数点BMI9N011000000000001/ClinicalDocument/.../entry/observation[code/@code='9N011000000000001']/value@value / @unitPQkg/m2-1: 丸め、小数点腹囲（実測）9N016160100000001/ClinicalDocument/.../entry/observation[code/@code='9N016160100000001']/value@value / @unitPQcm-1: 丸め、小数点、欠損時「測定不能」収縮期血圧（1回目）9A751000000000001/ClinicalDocument/.../entry/observation[code/@code='9A751000000000001']/value@value / @unitPQmmHg-1: 丸め、桁数超過空腹時血糖3C010000001926103/ClinicalDocument/.../entry/observation[code/@code='3C010000001926103']/value@value / @unitPQmg/dL1.2.392.200119.6.1007 (検査方法コード用)1: 丸め、欠損時「測定不能」HbA1c(NGSP)3D046000001927102/ClinicalDocument/.../entry/observation/value@value / @unitPQ%1.2.392.200119.6.1007 (検査方法コード用)1: 丸め服薬1（血圧）9N701000000000011/ClinicalDocument/.../entry/observation[code/@code='9N701000000000011']/value@code / @codeSystemCD-1.2.392.200119.6.2003 (はい/いいえ)1: 未回答時欠損扱い喫煙9N736000000000011/ClinicalDocument/.../entry/observation[code/@code='9N736000000000011']/value@code / @codeSystemCD-1.2.392.200119.6.24060 (喫煙区分)1: 未回答時欠損扱いメタボリックシンドローム判定9N501000000000011/ClinicalDocument/.../entry/observation[code/@code='9N501000000000011']/value@code / @codeSystemCD-1.2.392.200119.6.1008 (判定コード)1: 欠損値ある場合の判定保健指導レベル9N506000000000011/ClinicalDocument/.../entry/observation[code/@code='9N506000000000011']/value@code / @codeSystemCD-1.2.392.200119.6.3001 (レベルコード)1: 欠損値ある場合の判定1
4. 納品ルールへの準拠 (Adhering to Delivery Rules)
特定健診・特定保健指導データのXMLファイル群を正しく生成した後、これらを指定された納品ルールに従ってパッケージ化し提出することが不可欠です。納品ルールは、フォルダ構成、ファイル命名規則、アーカイブ方法、そしてXMLスキーマの配置に及びます。これらのルールを遵守することで、受信側システムでの自動処理とデータの正確な取り込みが保証されます。
4.1. フォルダ構成 (Folder Structure)
送付用ファイルアーカイブは、1「送付用ファイルアーカイブ仕様説明書 Version 4.0」の2.1節に規定された厳格なフォルダ階層構造に従って作成する必要があります 1。この構造は、ファイルの種類に応じた論理的なグループ化を提供し、受信側での処理を容易にします。
主要なフォルダ構成は以下の通りです。
● ルートフォルダ: アーカイブ全体の最上位フォルダ。このフォルダ名は後述する命名規則に従います。ルートフォルダ直下には、交換用基本情報ファイル（ix08_V08.xml）と決済情報集計ファイル（su08_V08.xml）が配置されます 1。
● DATAフォルダ: ルートフォルダの直下に作成されるサブフォルダで、名称は「DATA」固定です。ここには、個々の受診者または利用者の健診結果データや保健指導結果データを格納するXMLファイル、すなわち特定健診情報ファイル（hc08_V08.xml形式）および特定保健指導情報ファイル（hg08_V08.xml形式）が配置されます 1。
● CLAIMSフォルダ: ルートフォルダの直下に作成されるもう一つのサブフォルダで、名称は「CLAIMS」固定です。ここには、費用決済に関連するXMLファイル、すなわち特定健診決済情報ファイル（cc08_V08.xml形式）および特定保健指導決済情報ファイル（gc08_V08.xml形式）が配置されます 1。
● XSDフォルダ: ルートフォルダの直下に作成されるサブフォルダで、名称は「XSD」固定です。このフォルダには、当該提出パッケージに含まれる全てのXMLファイルの妥当性検証に必要なXMLスキーマ定義ファイル（.xsdファイル）が格納されます。これには、各XMLファイルタイプに対応するスキーマ（例：hc08_V08.xsd, hg08_V08.xsdなど）に加え、これらが参照する共通スキーマファイル群も含まれます 1。
この階層構造を正確に再現することが、納品ルールの基本となります。
4.2. ファイル命名規則 (File Naming Conventions)
ファイル命名規則は、ルートフォルダ名と、その中に格納される個々のXMLファイル名の両方に対して詳細に規定されています。これらの規則に従うことで、各ファイルの内容、送信元、送信先、作成日時などが一意に識別可能となり、自動処理の基盤となります。
ルートフォルダ名の命名規則 1:
ルートフォルダ名は、以下の構成要素をアンダースコア（_）で連結して命名します。
提出元機関番号_提出先機関番号_提出年月日_同日分割送信回数_実施区分コード
各構成要素の詳細は以下の通りです。

構成要素名説明桁数/フォーマット設定ルール/例参照仕様提出元機関番号データ提出元の機関を識別する番号。8～10桁の数字交換パターンにより桁数や種類が異なる。例: 健診機関番号「1234567890」。事業者から保険者への提出時は「5521111111」等。表1, 表2, 表4提出先機関番号データ提出先の機関を識別する番号。7～10桁の数字またはコード交換パターンにより桁数や種類が異なる。例: 保険者番号「12345678」。事業者への提出時は出現しない場合がある。表1, 表2提出年月日当該提出パッケージの作成・提出日。8桁の数字 (YYYYMMDD)例: 「20240612」表1同日分割送信回数同一送信元から同一送信先へ同日に複数回送信する場合の識別番号。1桁の数字1回目は「0」、2回目以降は「1」,「2」…とインクリメント。これにより、同日内の再提出や分割提出を区別。表1実施区分コードアーカイブ全体の内容を示すコード。1桁の数字例: 「1」(特定健診情報), 「2」(特定保健指導情報), 「3」(国への実績報告(匿名化済)), 「4」(他の健診結果), 「5」(国への実績報告(匿名化前))。表1, 表5XMLファイル名の命名規則 1:
DATAフォルダおよびCLAIMSフォルダに格納される個別のXMLファイル（交換用基本情報ファイルと決済情報集計ファイルを除く）は、以下の構成要素を連結して命名します。
プレフィックス + 健診機関番号 + ファイル生成日付 + 同一フォルダ内識別番号.xml
各構成要素の詳細は以下の通りです。

構成要素名説明桁数/フォーマット設定ルール/例参照仕様プレフィックスファイルの種類を識別する1文字のアルファベット。1文字h: 特定健診データファイル, c: 特定健診決済情報ファイル, g: 特定保健指導データファイル, p: 特定保健指導決済情報ファイル。表8健診機関番号データ生成元（通常は健診・保健指導実施機関）の機関番号。10桁の数字事業者等から保険者へ提出する場合は特別な機関番号「5521111111」または「6631111116」を使用。表8ファイル生成日付当該XMLファイルが生成された日付。8桁の数字 (YYYYMMDD)例: 「20240521」表8同一フォルダ内識別番号同一健診機関が同日に生成するファイルを一意に識別するための番号。8桁の数字健診機関が任意に採番する連番など。これにより、同一機関・同一日付で複数のファイルを生成する場合の重複を避ける。表8交換用基本情報ファイルは常にix08_V08.xml、決済情報集計ファイルは常にsu08_V08.xmlという固定ファイル名でルートフォルダ直下に配置されます 1。
これらの命名規則は、提出パッケージの識別、内容の推定、および自動処理を可能にするための重要な規約です。特に、ルートフォルダ名の実施区分コードは、パッケージ全体の主要な内容を示すため、正確な設定が求められます。
4.3. アーカイブ方法 (Archiving Method)
作成された送付用データは、1「送付用ファイルアーカイブ仕様説明書」の2.3節に基づき、ZIP形式で圧縮して1つのファイルにまとめます 1。このZIP圧縮ファイルが、最終的な納品物となります。
圧縮ファイルのファイル名は、前述のルールに従って命名された「ルートフォルダ名.zip」とすることが規定されています。例えば、ルートフォルダ名が1234567890_87654321_20240612_0_1であれば、圧縮ファイル名は1234567890_87654321_20240612_0_1.zipとなります。
ZIP形式は広く普及しており、特別なソフトウェアを必要とせずに多くの環境で扱えるため、データ交換の標準的なアーカイブ形式として採用されています。この規定に従うことで、送受信者間でのファイル取り扱いの互換性が保証されます。
4.4. XMLスキーマの配置 (XML Schema Placement)
生成されたXMLファイルが仕様に準拠していることを検証可能にするため、および受信側が正確にデータを解釈できるようにするために、関連する全てのXMLスキーマファイル（XSDファイル）を提出用アーカイブに含める必要があります。これらのスキーマファイルは、1「送付用ファイルアーカイブ仕様説明書」の2.1.4節および1「XMLスキーマ説明書」の指示に従い、ルートフォルダ直下の「XSD」という名前のフォルダ内に配置します 1。
特に重要なのは、ファイル名を変更せず、指定された階層構造を維持することです。1によれば、共通XMLスキーマであるdatatypes_hcgv08.xsd, voc_hcgv08.xsd, narrativeBlock_hcgv08.xsd, datatypes-base_hcgv08.xsdの4ファイルは、XSDフォルダ内のさらに「coreschemas」という名前のサブフォルダに配置することが前提となっています 1。
この正確な配置は、XMLスキーマファイル間の参照関係（<xs:import>や<xs:include>など）が正しく解決されるために不可欠です。XMLパーサやバリデータは、これらのスキーマ定義に基づいてXMLファイルの構造やデータ型を検証するため、スキーマファイルが期待される場所に正しい名前で存在しない場合、検証プロセスが失敗する可能性があります。提出パッケージにスキーマファイルを含めることで、送信側が意図したスキーマバージョンに基づいてファイルが検証されることを保証し、データ交換の信頼性を高めます。
4.5. 各交換パターンにおけるファイル構成 (File Composition for Different Exchange Patterns)
送付用ファイルアーカイブに含めるべきXMLファイルの種類と数は、1「送付用ファイルアーカイブ仕様説明書」の2.4節 表9に示されるように、データの交換パターン（誰から誰へ、どのような目的でデータを送付するか）によって異なります 1。全てのファイルが常に必須というわけではなく、シナリオに応じて構成が変動します。
例えば、以下のようなケースが考えられます。
● 特定健診機関から保険者へ、健診結果と決済情報を送付する場合:
○ ルートフォルダ: ix08_V08.xml (交換用基本情報), su08_V08.xml (決済情報集計)
○ DATAフォルダ: hc08_V08.xml (特定健診情報)
○ CLAIMSフォルダ: cc08_V08.xml (特定健診決済情報)
○ XSDフォルダ: 関連スキーマ一式 この場合、特定健診に関連する全ての情報ファイルと決済ファイル、およびそれらを統括する基本情報ファイルと集計ファイルが含まれます。
● 個別契約に基づき、健診機関から委託元（保険者など）へ健診結果データのみを送付する場合:
1のP10には、「個別契約の場合には、健診結果データのみ、または、保健指導結果データのみを委託元に提出する場合がありうる。その場合には、健診(保健指導)決済情報ファイル、及び、決済情報集計ファイルを含める必要はなく、健診(保健指導) 結果データ、XMLスキーマファイル、及び、交換用基本情報ファイルのみを送付用アーカイブファイルに含める」と記載されています 1。
このケースでは、アーカイブ構成は以下のようになります。
○ ルートフォルダ: ix08_V08.xml (交換用基本情報)
○ DATAフォルダ: hc08_V08.xml (特定健診情報)
○ CLAIMSフォルダ: (空、またはフォルダ自体が存在しない)
○ XSDフォルダ: 関連スキーマ一式 決済情報集計ファイル（su08_V08.xml）もこの場合は不要となります。
● 事業者から保険者へ、事業者健診の結果（特定健診項目分）を送付する場合:
この場合、ルートフォルダ名の提出元機関番号には特別なコード（「5521111111」または「6631111116」）が使用され 1、実施区分コードは「4」（他の健診結果の受領分）などが考えられます。ファイル構成は、特定健診情報ファイル（hc08_V08.xml）と交換用基本情報ファイル（ix08_V08.xml）、およびXSDファイル群が中心となるでしょう。決済の有無により決済関連ファイルの要否が決定されます。
このように、交換の目的や契約形態に応じて、アーカイブに含めるべきファイル群が選択されます。しかし、どのようなパターンであっても、交換用基本情報ファイル（ix08_V08.xml）とXSDフォルダ（関連スキーマ一式）は、パッケージの定義と検証可能性を担保するために、多くの場合において必須の構成要素と考えられます。データファイル（hc08_V08.xml, hg08_V08.xml）や決済関連ファイル（cc08_V08.xml, gc08_V08.xml, su08_V08.xml）の要否は、具体的なトランザクションの内容によって決定されます。
5. 検証とベストプラクティス (Validation and Best Practices)
5.1. XMLスキーマ検証の重要性 (Importance of XML Validation against Schemas)
生成された各XMLファイルが、指定されたXMLスキーマ定義（XSDファイル）に対して妥当であるかを確認する検証プロセスは、データ交換の品質を保証する上で極めて重要です 1。XMLスキーマは、XML文書が従うべき構造、要素、属性、データ型、順序、出現回数などのルールを定義します。スキーマ検証を行うことで、以下のような利点が得られます。
● 構文的正確性の保証: XMLファイルがスキーマに定義された構文規則（タグの閉じ忘れ、不正な要素のネスト、誤った属性の使用など）に違反していないかを確認できます。
● データ型の一致確認: 各要素や属性の値が、スキーマで定義されたデータ型（例：整数、文字列、日付、コード値）と一致しているかを確認できます。
● 必須項目・出現回数の遵守: 必須要素の欠落や、許容される出現回数を超えた要素の存在などを検出できます。
スキーマ検証は、データ提出前の最終チェックとして機能し、受信側システムでの処理エラーやデータの誤解釈を防ぐための基本的な手段です。提出パッケージに同梱されるXSDフォルダ内のスキーマファイルを用いて検証を行うことで、送信側と受信側が同一の規約に基づいてデータを扱っていることが保証され、システム間の相互運用性が向上します。
5.2. データ整合性チェックと規則遵守 (Data Consistency Checks and Adherence to Rules)
XMLスキーマ検証は主にXML文書の構造的な妥当性を保証しますが、それだけではデータの完全な正確性を担保するには不十分です。意味的な正しさや業務ルールへの準拠を確認するためには、追加的なデータ整合性チェックが必要です。
● データ処理規則の遵守: 「参考資料」1で定義されている数値データの丸め方、小数点以下の扱い、桁数超過時の処理、欠損値の表現方法（例：「測定不能」、「未実施」コードの使用）などが、XMLファイル生成時に正しく適用されているかを確認する必要があります。これらの規則は、データの標準化と一貫した解釈のために不可欠です。
● ファイル間での識別子の一貫性: 送付ファイルアーカイブには複数のXMLファイルが含まれる場合があります。例えば、特定健診情報ファイル（hc08_V08.xml）とその決済情報ファイル（cc08_V08.xml）は、同一受診者に関する情報を含みます。これらのファイル間で、受診者を一意に識別するための情報（例：被保険者番号、氏名、生年月日など）や、健診機関番号などが完全に一致している必要があります。1のファイル概念図が示すように、これらのファイルは受診者情報によって紐付けられるため、識別子の一貫性はデータ連携の正確性に直結します 1。
● OIDの正しい使用: 「OID(オブジェクトID) 表」1に記載されているOIDは、保険者番号、機関番号、各種コード体系などを一意に識別するために用いられます。XMLファイル内の@root属性や@codeSystem属性に、文脈に応じた正しいOIDが設定されているかを確認することが重要です。誤ったOIDの使用は、データの意味を根本的に変えてしまう可能性があります。
● コード値の妥当性: 各種健診項目1や保健指導項目1、あるいは決済情報1で使用されるコード値が、それぞれの仕様書で定義された有効なコードリストに含まれているかを確認する必要があります。
これらの整合性チェックは、スキーマ検証を補完し、より高品質で信頼性の高いデータ交換を実現するために不可欠です。
5.3. 変換プロセスにおける推奨事項 (Recommendations for the Conversion Process)
CSVファイルから複雑な構造を持つXMLファイル群への変換プロセスを円滑かつ正確に進めるためには、いくつかの推奨事項があります。
● 段階的な開発とテスト: 全てのXMLファイルタイプとデータ項目を一度に変換しようとするのではなく、ファイルタイプごと、あるいは主要なデータセクションごとに段階的に変換ロジックを開発し、各段階で十分なテスト（スキーマ検証、目視確認、サンプルデータとの比較など）を行うことが推奨されます。これにより、問題の早期発見と修正が容易になります。
● 詳細なログ記録: 変換プロセス中に、どのCSVデータがどのXML要素・属性にマッピングされたか、どのようなデータ変換（型変換、コード変換、丸め処理など）が適用されたか、そしてエラーや警告が発生した場合にはその詳細な情報をログとして記録することが重要です。これらのログは、問題発生時の原因究明や、変換プロセスの監査証跡として役立ちます。
● 堅牢なエラーハンドリング: CSVデータには予期せぬ形式のデータや欠損値が含まれる可能性があります。変換ロジックには、これらの例外的な状況を適切に処理するためのエラーハンドリング機構を組み込むべきです。例えば、不正なデータ型の場合は警告を記録しつつデフォルト値や欠損値表現を用いる、必須項目が欠落している場合はエラーとして処理を中断する、といった対応が考えられます。
● 参照資料の活用と理解: 本報告書で参照している全ての技術文書（1～1）の内容を十分に理解し、特にデータ項目定義（1）、OID定義（1）、データ処理ルール（1）、各XMLファイル仕様、そして納品ルール（1）を正確に把握することが、変換品質の向上に繋がります。
これらの推奨事項を実践することで、変換プロセスの信頼性と効率性を高め、仕様に準拠した高品質なXMLファイルの生成が期待できます。
6. 結論 (Conclusion)
6.1. 主要ステップの要約 (Summary of Key Steps)
特定健診・特定保健指導データ交換用のCSVファイルをXMLファイル群に変換し、指定された納品ルールに従って納品するプロセスは、以下の主要なステップに集約されます。
1. CSVデータの準備と理解: 提供された技術文書に基づき、変換元となるCSVデータの構造、項目、データ型、コード値、そして1で規定されるデータ処理ルール（丸め、欠損値の扱い等）を正確に把握します。
2. 各XMLファイルへの変換: 交換用基本情報ファイル、特定健診情報ファイル、特定保健指導情報ファイル、各決済情報ファイル、決済情報集計ファイルそれぞれについて、CSVデータを対応するXML要素・属性へマッピングします。この際、HL7 CDA R2規格（特定健診・保健指導情報ファイルの場合）、OIDの正しい使用、データ型変換、条件分岐、繰り返し要素の処理などを仕様書に従って正確に実装します。
3. 納品ルールの遵守: 生成されたXMLファイル群を、1で規定されたフォルダ構成（DATA, CLAIMS, XSDフォルダ等）、ファイル命名規則（ルートフォルダ名、各XMLファイル名）、そしてZIP形式によるアーカイブ方法に従って厳格にパッケージ化します。XSDスキーマファイル群も正しい位置に配置します。
4. 検証: 生成されたXMLファイルが対応するXSDスキーマに対して妥当であること、およびデータ処理ルールやファイル間の整合性が保たれていることを確認します。
これらのステップを通じて、技術仕様に完全に準拠した納品パッケージが作成されます。
6.2. データ交換成功のための仕様遵守の徹底 (Emphasis on Meticulous Adherence to Specifications for Successful Data Exchange)
本報告書で詳述したCSVファイルからXMLファイルへの変換プロセス、およびそれに付随する納品ルールは、特定健診・特定保健指導データの円滑かつ正確な電子交換を実現するための基盤です。このデータ交換の成功は、提供された全ての技術文書に記載された仕様の細部に至るまでの、徹底した遵守にかかっています。
データ項目の定義、コード値の正確な使用、数値データの処理方法、XML要素・属性の構造、OIDの適切な設定、ファイル命名規則、フォルダ構成、アーカイブ方法など、いずれの要素もデータ交換システム全体が正しく機能するために不可欠です。些細な仕様からの逸脱が、データの不整合、処理エラー、ひいてはシステム間の相互運用性の阻害を引き起こす可能性があります。
したがって、本データ交換に関わる全ての担当者は、本報告書および参照された一次資料（1～1）を熟読し、その内容を正確に理解した上で、変換・納品作業にあたることが強く求められます。仕様の細部に対する注意深い配慮と厳格な遵守こそが、信頼性の高いデータ交換システムを構築し、その恩恵を最大限に享受するための鍵となります。
引用文献
1. 001082798.pdf
